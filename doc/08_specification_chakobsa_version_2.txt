### Fuzzer scripts:

Internal supervisor commands:

External supervisor commands:

- Test
Prints arguments to output

- TestAgain
Prints modified arguments to output

- PrintLogo
Prints logo to output

- GetOptions (deprecated)
Performs option parsing in order to acquire parameters

- EnableLogging
Enable logging on host to file defined in settings

- RegisterSignals
Args: String a1
Registers a label used in exceptions (defaults to: 'exception')

- PrepareStats (undocumented)

- PreparePipes
Configures monitor pipes & serial pipes

- ChooseSavedMethod 
Decision: "AM" | "GM"
Checks what method for generating analysis batch has been chosen (autogenerated or glob)

- GlobMethod
Creates saved disk using glob method
[TODO: change names]

- GlobPattern
Args: String a1
Glob pattern for creating shared disk with glob method

- DiskGlob
Creates shared disk using glob method
[TODO: change names]

- AutogeneratedMethod
Creates saved disk using autogenerated method
[TODO: change names]

- AutogeneratedDisk
Creates shared  disk using autogenerated method
[TODO: change names]

- QemuArgsResearchDir 
Passes the research dir to be used (set with: SetResearchDir) to Qemu

- QemuArgsKVM
Enable KVM support for Qemu

- StartQemuFull (alias: QemuStart)
Performs full qemu start based on loaded parameters

- StartQemuLoad
Performs qemu start with revert to state with name defined in settings

- QemuLoad
Args: String a1 
Loads a Fuzzer state with id a1. 
Note: Fuzzer state means Qemu state + pickled fuzzer state (loaded from .state file)

- QemuSave
Args: String a1 
Save a Fuzzer state with id a1. 
Note: Fuzzer state means Qemu state + pickled fuzzer state (saved into .state file)

- QemuDel
Args: String a1 
Delete a Fuzzer state with id a1. 
Note: Fuzzer state means Qemu state + pickled fuzzer state (deleting .state file)

- QemuMountDisks
Mounts shared and saved disks w virtio drivers based on parameters in settings

- QemuMountDisksNoVirtio
Mounts shared and saved disk w/o virtio drivers based on parameters in settings

- SpawnInternalController
Spawns internal controller

- SpawnInternalControllerFileLogSmb
Run python_spawn_internal_controller_file_log_smb interaction script, which spawns internal controller from SMB share WITH logging to a file

- SpawnInternalControllerSmb
Run python_spawn_internal_controller_file_log_smb interaction script, which spawns internal controller from SMB share WITHOUT logging to a file

- SpawnInternalControllerWoThread
Spawns internal controller w/o threads [what are threads?]

- QemuConnectDevSocket
Attempts to connect to qemu control socket

- IsSocketConnected
Decision: "Y" or "N"
Decides if qemu control socket has been connected to successfully 

- Wait10
Waits 10 seconds

- Wait
Args: Float a1
Waits a1 seconds

- KillExplorer
Kills explorer :)

- ResetTracers
Sets tracer count to 0 in State

- SpawnTracerController
Starts tracer controller 
By sending start_trace_controller to internal controller

- SpawnTracerScrLog
Starts tracer WITH logging to screen (slow) 
By sending spawn_tracer to internal controller

- SpawnTracerFileLog
Starts tracer WITH logging to file 
By sending spawn_tracer to internal controller

- SpawnTracerRemoteLog
Starts tracer WITH logging to file 
By sending spawn_tracer to internal controller

- SpawnTracerNoLog
Starts tracer WITHOUT logging 
By sending spawn_tracer to internal controller

- SpawnTracer (backwards compatibility alias)
Alias to: SpawnTracerScrLog

- SpawnTracerLog (backwards compatibility alias)
Alias to: SpawnTracerFileLog

- GetSampleOptions (deprecated)

- RevertClean
Perform offline qemu image revert to state from settings

- RevertReady (deprecated)

- TracerConfigureSample
Set the sample name for the current research

- TracerConfigureSamplePID
Set the sample (process) PID for the current research

- TracerConfigureOutDir
Configure the output directory for the research 
By sending tracer_configure_out_dir command to internal controller

- TracerAppendOutPrefix
Append prefix for output artifacts for the research to $a1 (for differentiation between researches in the same RE research (based on globs.state.out_prefix)
By sending tracer_append_out_prefix command to internal controller

- TracerAppendPIDPrefix
Append prefix based on PID of traced process (used in attaching subsequent tracers), which is set with: TracerConfigureSamplePID
By sending tracer_append_pid_prefix command to internal controller

- TracerConfigureOutPrefix
[TODO]

- TracerConfigurePIDPrefix
[TODO]

- TracerConfigureInDir
Configure input directory for the research [TODO]

- TracerPrepareTrace
What does it do?
[TODO]

- TracerRegisterRegions
Register Regions for later use by the tracer according to Regions syntax

- TracerRegisterReactions
Register Ractions for later use by the tracer according to Reactions syntax

- TracerRegisterBuiltin
- DisableReactions
- TracerDebugSample
- TracerAttachSample
- TracerDebugContinueInf
- Decision
- EnableReaction
- RaiseReaction
- LowerReaction
- ExclusiveReaction
- AutorepeatReaction
- DisableReaction
- EnableBuiltin
- ExclusiveBuiltin
- LowerBuiltin
- DumpMemory
- TracerStartTrace
- TracerStartStrace
- TracerStartTraceDebug
- TracerStartTraceLight
- ReadRegister
- WriteRegister

- Adjust
Args: Integer a1
Adds a1 to the value on internal stack

ReadDword
WriteDword
ReadPID
ReadTID
ReadEP
TracerPrev
TracerNext
CloseTracer

- CheckEqual
Args: Integer a1
Decision: "Y" or "N"
Checks if internal ret is equal to a1

AutoST
ResumeThread
WriteLastSuspension
ReadLastSuspension
WhichTracer
MoreTracers
ReadPrefix
ListProcesses
ListTebs
ListAllTebs
LoadEP
SaveFirstEP
SaveEP
SaveOffset
SaveSize
ReadRegion
OutRegion
ManualST
ManualSTArg
ManualSTwSelf
SetSampleFile

- SetResearchDir
Set the research dir to be used via qemu-emulated SMB server

SetOutDir
CheckHostDir
ReadArgUni
ReadArgAnsi
ReadArg
SecureAllSections
ExtractEP
RunRoutine
Spawn
Cooldown
ReadStack
SpawnResponder80
SpawnResponder
NextResponse
SpawnMailslot
MailslotNextResponse
ResolveDNS
GetHTTP
StartLog
ChangeIP
RunCmd

- RunCmdHost
Args: String a1
Runs the command a1 in external host
WARNING!!! Disable before parsing untrusted scripts!!!

ReadAnsi
WriteAnsi
ReadUnicode
WriteUnicode

- Execute
Do nothing [? for backward compatibility ?]

- Push
Args: String a1 (or internal ret)
Pushes a1 onto internal stack

- Pop
Ret: String
Pops from internal stack to internal ret
[TODO: make sure integers are converted to strings]

- Enqueue
Args: String a1
Enqueues s1 into internal queue

- Dequeue
Ret: String
Dequeues from internal queue
[TODO: make sure integers are converted to strings]

- ClearStack
Clears internal stack
[TODO: create clear queue command]

Interrupt

- QemuQuit
Turns off logging and executes quit command in qemu control socket

TracerSetParameters

- Beep
Executes 'beeep' command, which should be a script notifying the user

Print
DumpFile

- Pause
Waits for user interaction before proceeding

ResolveLocation

- Int10
Args: String a1 or internal ret
Ret: Integer
Converts argument to integer using base 10

- Int16
Args: String a1 or internal ret
Ret: Integer
Converts argument to integer using base 16

- SetCounter
Args: Integer a1
Sets internal counter to a1

- GetCounter
Ret: Integer
Returns internal counter and decreases by 1

- CheckCounter
Decision: "Y" or "N"
Makes decision if internal counter is 0x0 or decreases by 1

