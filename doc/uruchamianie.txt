options:

    parser.add_option("-M", "--machines",       dest="machines", help="Machines path", default=settings.qemu_machines)
    parser.add_option("-a", "--hda",            dest="hda", help="First disk")
    parser.add_option("-b", "--hdb",            dest="hdb", help="Second disk")
    parser.add_option("-c", "--cdrom",          dest="cdrom", help="CD")
    parser.add_option("-m", "--m",              dest="qemu_m", help="Amount of memory", default=settings.qemu_m)
    parser.add_option("-S", "--scripts",        dest="scripts", help="Scripts to start with")
    parser.add_option("-o", "--origin",         dest="origin", help="Original file")
    parser.add_option("-s", "--shared",         dest="shared_folder", help="Folder for shared applications", default=settings.qemu_shared_folder)
    parser.add_option("-d", "--samples-shared", dest="samples_shared", help="Folder for shared samples", default=settings.samples_shared_path)
    parser.add_option("-v", "--samples-saved",  dest="samples_saved", help="Folder for saved samples", default=settings.samples_saved)
    parser.add_option("-B", "--samples-binned", dest="samples_binned", help="Folder for binned samples", default=settings.samples_binned)
    parser.add_option("-i", "--fuzzbox_ip",     dest="fuzzbox_ip", help="Force fuzzbox ip (normally based on hda)")
    parser.add_option("-p", "--fuzzbox_port",   dest="fuzzbox_port", help="Force fuzzbox port (normally based on hda)")
    parser.add_option("-V", "--visible",        dest="visible", help="Should box be visible?", action="store_true", default=settings.visible)
    parser.add_option("-l", "--slowdown",       dest="slowdown", help="Slowdown (default is 1)", default=settings.slowdown)
    parser.add_option("-e", "--extension",      dest="extension", help="Extension of generated sample", default=settings.extension)
    parser.add_option("-n", "--mutation-number", dest="mutations", help="Number of mutations to perform", default=settings.mutations)
    parser.add_option("-D", "--orig-samples-dir", dest="samples_orig", help="Path to original samples", default="")
    parser.add_option("-P", "--sample",         dest="sample", help="Path to sample", default="")
    parser.add_option("-C", "--command",        dest="obs_command", help="Observer command", default="testStEndMarkers")
    parser.add_option("-L", "--timeout",        dest="wait_sleep", help="Timeout for state transitions", default=settings.wait_sleep)
    parser.add_option("-O", "--count",          dest="samples_count", help="Amount of samples in single run", default=10)
    parser.add_option("-T", "--tap",            dest="tap", help="Tap interface", default="tap0")
    parser.add_option("-r", "--metric-res",     dest="metric_res", help="Metrics resolution", default=settings.metric_res)
    parser.add_option("-A", "--save-disks",     action="store_true", dest="save_disks", help="Save disks even if they don't contain crashing", default=settings.save_disks)
    parser.add_option("-N", "--vnc",            action="store_true", dest="vnc", help="Use VNC", default=settings.vnc)
    parser.add_option("-R", "--profiling",      action="store_true", dest="profiling", help="Use profiling", default=settings.profiling)
    parser.add_option("-k", "--taskset",        action="store_true", dest="use_taskset", help="Use taskset", default=settings.use_taskset)
    parser.add_option("-t", "--to-mult-factor", dest="to_mult_factor", help="Factor for calculating SO timeout based on TO (SO=TO*factor)", default=settings.to_mult_factor)
    parser.add_option("-w", "--boot-wait",      dest="boot_wait", help="How long does this system boot", default=settings.boot_wait)
    parser.add_option("-I", "--revert-wait",    dest="revert_wait", help="How long does this system revert", default=settings.revert_wait)
    parser.add_option("-W", "--shutdown-wait",  dest="shutdown_wait", help="How long does this system shutdown", default=settings.shutdown_wait)
    parser.add_option("-f", "--init-timeout",   dest="init_timeout", help="Timeout for binner initiation", default=settings.init_timeout)
    parser.add_option("-z", "--samples-size-margin", dest="samples_size_margin", help="Size marigin of single sample for disk size calculations", default=settings.samples_size_margin)
    parser.add_option("-u", "--smp",            dest="smp", help="Number of vCPUs", default=settings.smp)
    parser.add_option("-K", "--generator",      dest="generator", help="Generator to use", default=settings.generator)
    parser.add_option("-E", "--mutator",        dest="mutator", help="Mutator to use", default=settings.mutator)
    parser.add_option("-G", "--loop-function",  dest="loop", help="Loop function to use", default="dummy")
    parser.add_option("-H", "--samples-source", dest="samples_source", help="Samples source to use", default="autogenerated_batch")
    parser.add_option("-J", "--glob",           dest="glob_pattern", help="Glob pattern to use for glob sample source", default=None)
    parser.add_option("-j", "--wait-key",       action="store_true", dest="wait_key", help="Wait for keystroke", default=False)
    parser.add_option("-U", "--walk-level",     dest="walk_level", help="Walk level", default="3")
    parser.add_option("-X", "--ws",             dest="walk_start", help="Walk start address (should be call)", default=None)
    parser.add_option("-g", "--args",           dest="args", default=None)
    parser.add_option("-F", "--output",         dest="out_path", default='./heis-out')

additional optionsi (for tracing):

    parser.add_option("", "--smod",       dest="st_mod", help="Starting module for trace", default="0x0")
    parser.add_option("", "--emod",       dest="end_mod", help="Ending module for trace", default="kernel32.dll")
    parser.add_option("", "--saddr",      dest="st_addr", help="Starting address for trace", default="0x1b7c")
    parser.add_option("", "--eaddr",      dest="end_addr", help="Ending address for trace", default="0x52acf")
    parser.add_option("", "--odir",       dest="out_dir", help="Out dir for trace", default="\\\\10.0.2.4\\qemu\\")
    parser.add_option("", "--odir2",      dest="out_dir2", help="Appendix for trace output", default="last")
    parser.add_option("", "--prefix",     dest="prefix", help="Prefix for trace", default="last")
    parser.add_option("", "--logpath",    dest="log_path", help="Log path for trace", default="\\\\10.0.2.4\\qemu\\last_log.txt")
    parser.add_option("", "--limit",      dest="instr_limit", help="Instruction limit", default="0")


--

generic_zero_trace:
cd .; ./fuzzer-stateful.py <define samples> <start address> <limits> <outdir> <machine used> generic_zero_trace

e.g.:
cd .; ./fuzzer-stateful.py -H glob -J /home/hs1/malware_samples/FDAF8903EFAE7F6B1AE6ABC949A53F638E94FA38-locky.exe --saddr 0x5000 --limit 5000000 --odir2 locky_2 hs2-06 generic_zero_trace

ograniczenie liczby analizowanych instrukcji:
/home/hs1/hs2-current-deploy/trace-tools/client/caller_taint -i intro.txt -d last_dump.bin -s 0x00405000 -e 50000000 -m last_mods.bin -I -D 3 2> log.txt
--

xara_trace:
cd .; ./fuzzer-stateful.py <define samples> 

e.g.:
cd .; ./fuzzer-stateful.py -H glob -J "*.xar" -F /mnt/2/output/xara-3.out --odir2 test_1 --saddr 0xaf89d4 --limit 100000000 hs2-05 xara_trace 

--

graph:

cd instruction dir
/home/hs1/hs2-current-deploy/trace-tools/client/caller_taint -i <instruction_file> -d <dump_file> -s <start addr> -m <mod_file> -I -D 3

e.g.:
/home/hs1/hs2-current-deploy/trace-tools/client/caller_taint -i last_instr_all.txt -d last_dump.bin -s 0x00ef89d4 -m last_mods.bin -I -D 3

